local players, bonus, admins = {}, {}, {
    ["Poklava#0000"] = true,
    ["Kralizmox#0000"] = true
}
local mapPlaying, maps = 0,
    {'<C><P L="4000" H="3500" F="1" DS="m;1547,1200,1239,1043,1898,1201,1287,1201" MEDATA=";;;;-0;0:::1-"/><Z><S><S T="9" X="1116" Y="1199" L="257" H="33" P="0,0,0,0,0,0,0,0"/><S T="12" X="1132" Y="976" L="290" H="180" P="0,0,0,0,0,0,0,0" o="2F1540" c="4"/><S T="0" X="2086" Y="1081" L="10" H="410" P="0,0,0.3,0.2,0,0,0,0"/><S T="0" X="1402" Y="1120" L="10" H="162" P="0,0,0,0.2,-50,0,0,0" c="3"/><S T="12" X="1248" Y="1203" L="10" H="44" P="0,0,0.3,0.2,0,0,0,0" o="A77545" N=""/><S T="0" X="1337" Y="1165" L="10" H="205" P="0,0,0.3,0.2,0,0,0,0" c="4"/><S T="0" X="1431" Y="1144" L="10" H="243" P="0,0,0.3,0.2,-50,0,0,0" c="4"/><S T="0" X="985" Y="1084" L="10" H="408" P="0,0,0.3,0.2,0,0,0,0"/><S T="0" X="1534" Y="881" L="1112" H="10" P="0,0,0.3,0.2,0,0,0,0" N=""/><S T="0" X="1278" Y="942" L="10" H="118" P="0,0,0.3,0.2,0,0,0,0" N=""/><S T="6" X="1536" Y="1250" L="1100" H="71" P="0,0,0.3,0.2,0,0,0,0" N=""/><S T="12" X="1119" Y="1220" L="267" H="10" P="0,0,0.3,0.2,0,0,0,0" o="A77545" N=""/><S T="0" X="1167" Y="1066" L="365" H="14" P="0,0,0.3,0.2,0,0,0,0" N=""/></S><D><P X="2056" Y="1216" T="67" P="0,1"/><P X="2005" Y="1216" T="68" P="1,0"/><P X="1954" Y="1216" T="67" P="0,0"/><P X="1844" Y="1216" T="67" P="0,1"/><P X="1793" Y="1216" T="68" P="1,0"/><P X="1742" Y="1216" T="67" P="0,0"/><P X="1095" Y="1062" T="17" P="1,0"/><P X="1181" Y="1065" T="127" C="784939,A31638" P="1,0"/><P X="1012" Y="1065" T="127" C="784939,A31638" P="1,0"/><P X="1103" Y="1028" T="21" P="0,0"/><P X="1628" Y="1217" T="1" P="0,0"/><P X="1693" Y="1242" T="5" P="0,2"/><P X="1733" Y="1242" T="5" P="0,2"/><P X="1773" Y="1242" T="5" P="0,2"/><P X="1813" Y="1242" T="5" P="0,2"/><P X="1853" Y="1242" T="5" P="0,2"/><P X="1893" Y="1242" T="5" P="0,2"/><P X="1933" Y="1242" T="5" P="0,2"/><P X="1973" Y="1242" T="5" P="0,2"/><P X="2013" Y="1242" T="5" P="0,2"/><P X="2053" Y="1242" T="5" P="0,2"/><P X="1289" Y="1242" T="5" P="0,2"/><P X="1649" Y="1242" T="5" P="0,2"/><P X="1609" Y="1242" T="5" P="0,2"/><P X="1569" Y="1242" T="5" P="0,2"/><P X="1529" Y="1242" T="5" P="0,2"/><P X="1489" Y="1242" T="5" P="0,2"/><P X="1449" Y="1242" T="5" P="0,2"/><P X="1409" Y="1242" T="5" P="0,2"/><P X="1369" Y="1242" T="5" P="0,2"/><P X="1329" Y="1242" T="5" P="0,2"/><P X="2007" Y="1178" T="73" P="0,0"/><P X="1795" Y="1176" T="71" P="0,0"/><P X="1896" Y="1217" T="148" P="0,0"/><P X="1128" Y="918" T="192" P="1,0"/><P X="1099" Y="1024" T="52" P="1,0"/></D><O><O X="1115" Y="1186" C="610" P="0"/><O X="1335" Y="1046" C="612" P="0"/><O X="1421" Y="1201" C="604" P="0"/></O><L/></Z></C>',
     '<C><P reload="true" L="3000" G="0,0" bh="" H="3000" MEDATA="0,1;;;;-0;0::0,1,2,3,4,5,6,7:1-" segments="nogravmove" /><Z><S><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="26af2f" X="1500" c="4" Y="1500" T="12" H="3000" /><S P="0,0,0.3,0.2,90,0,0,0" L="3000" o="2b9732" X="1500" c="3" Y="-1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="-1500" c="3" Y="1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="4500" c="3" Y="1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="1500" c="3" Y="4500" T="12" H="3000" /><S P="1,999999,0.3,0,0,0,0,0" L="3000" X="1500" c="3" Y="3220" T="19" m="" H="40" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="-1500" Y="4500" T="12" H="3000" /><S P="1,999999,0.3,0,0,0,0,0" L="3000" X="1500" c="3" Y="-220" T="19" m="" H="40" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="4500" Y="4500" T="12" H="3000" /><S P="1,999999,0.3,0,0,0,0,0" L="40" X="-220" c="3" Y="1500" T="19" m="" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="4500" Y="-1500" T="12" H="3000" /><S P="1,999999,0.3,0,0,0,0,0" L="40" X="3220" c="3" Y="1500" T="19" m="" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="-1500" Y="-1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1dc525" H="10" Y="672" T="13" X="492" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1dc525" H="10" Y="1070" T="13" X="2518" /><S P="0,0,0.3,0.2,0,0,0,0" L="500" o="f5ff4a" X="2450" c="4" Y="1830" T="12" H="500" /><S P="0,0,0.3,0.2,90,0,0,0" L="52" o="ff8f00" X="2453" Y="2054" T="12" H="500" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="2207" c="3" Y="1818" T="19" H="420" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="2663" c="3" Y="1818" T="19" H="420" /><S P="0,0,0.3,0.2,0,0,0,0" L="52" o="ff8f00" X="2192" Y="1830" T="12" H="500" /><S P="0,0,0.3,0.2,0,0,0,0" L="52" o="ff8f00" X="2678" Y="1830" T="12" H="500" /><S P="0,0,0.3,0.2,0,0,0,0" L="1000" o="f5ff4a" X="1508" c="4" Y="653" T="12" H="500" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="1495" c="3" Y="665" T="19" H="420" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="1525" c="3" Y="665" T="19" H="420" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="1969" c="3" Y="665" T="19" H="420" /><S P="0,0,0.3,0.2,0,0,0,0" L="52" o="ff8f00" X="1510" Y="653" T="12" H="500" /><S P="0,0,0.3,0.2,90,0,0,0" L="52" o="ff8f00" X="1510" Y="429" T="12" H="1000" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="1048" c="3" Y="665" T="19" H="420" /><S P="0,0,0.3,0.2,0,0,0,0" L="52" o="ff8f00" X="1984" Y="653" T="12" H="500" /><S P="0,0,0.3,0.2,0,0,0,0" L="52" o="ff8f00" X="1033" Y="653" T="12" H="500" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="2540" T="13" X="515" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="2540" T="13" X="980" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="2095" T="13" X="515" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="2095" T="13" X="980" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="1650" T="13" X="515" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="1650" T="13" X="980" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="2095" T="13" X="1450" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="1650" T="13" X="1450" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1dc525" H="10" Y="2540" T="13" X="1450" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="d0d0d0" X="2733" Y="2570" T="12" H="500" /><S P="0,0,0.3,0.2,90,0,0,0" L="100" o="d0d0d0" X="2274" Y="2772" T="12" H="500" /><S P="0,0,0.3,0.2,90,0,0,0" L="100" o="d0d0d0" X="2274" Y="2372" T="12" H="500" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="d0d0d0" X="1813" Y="2570" T="12" H="500" /><S P="0,0,0.3,0.2,0,0,0,0" L="250" o="0046ff" X="349" c="4" Y="1241" T="13" H="10" /><S P="0,0,0.3,0.2,0,0,0,0" L="250" o="0046ff" X="1852" c="4" Y="1343" T="13" H="10" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="4500" c="3" Y="4500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="-1500" c="3" Y="4500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="4500" c="3" Y="-1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="-1500" c="3" Y="-1500" T="12" H="3000" /><S P="0,0,0.3,0,0,0,0,0" L="120" X="750" c="3" Y="2320" T="19" H="120" /><S P="0,0,0.3,0,0,0,0,0" L="120" X="1220" c="3" Y="1870" T="19" H="120" /><S P="0,0,0.3,0,0,0,0,0" L="120" X="2274" c="3" Y="2580" T="19" H="120" /><S P="0,0,0.3,0,180,0,0,0" L="40" X="1033" c="3" Y="1103" T="19" H="400" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="2192" c="3" Y="1380" T="19" H="400" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="492" c="3" Y="255" T="19" H="200" /><S P="0,0,0.3,0,0,0,0,0" L="80" X="145" c="3" Y="672" T="19" H="40" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="1510" c="3" Y="303" T="19" H="200" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="1813" c="3" Y="2020" T="19" H="600" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="1570" c="3" Y="1183" T="19" H="240" /><S P="0,0,0.3,0,90,0,0,0" L="40" X="2764" c="3" Y="2060" T="19" H="120" /><S P="0,0,0.3,0,0,0,0,0" L="40" X="980" c="3" Y="2880" T="19" H="240" /><S P="0,0,0.3,0,90,0,0,0" L="40" X="120" c="3" Y="2095" T="19" H="240" /><S P="0,0,0.3,0,90,0,0,0" L="40" X="2200" c="3" Y="653" T="19" H="380" /><S P="0,0,0.3,0,-90,0,0,0" L="40" X="2810" c="3" Y="653" T="19" H="380" /><S L="40" X="1270" H="40" Y="600" T="19" P="1,10000,0.3,0,0,0,0,0" /><S L="40" X="1745" H="40" Y="600" T="19" P="1,10000,0.3,0,0,0,0,0" /><S L="40" X="2435" H="40" Y="1890" T="19" P="1,10000,0.3,0,0,0,0,0" /><S P="1,999999,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="-1700" c="3" N="" Y="1500" T="12" H="3000" /><S P="1,999999,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="1500" c="3" N="" Y="4700" T="12" H="3000" /><S P="1,999999,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="4700" c="3" N="" Y="1500" T="12" H="3000" /><S P="1,999999,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="1500" c="3" N="" Y="-1700" T="12" H="3000" /></S><D><P X="870" Y="1190" T="1" P="1,0" /><P X="1376" Y="1464" T="1" P="1,0" /><P X="855" Y="1490" T="5" P="1,0" /><P X="755" Y="1896" T="5" P="1,0" /><P X="175" Y="2022" T="5" P="1,0" /><P X="1215" Y="2470" T="5" P="1,0" /><P X="1859" Y="2160" T="2" P="1,0" /><P X="2461" Y="2626" T="2" P="1,0" /><P X="729" Y="2847" T="2" P="1,0" /><P X="111" Y="888" T="2" P="1,0" /><P X="751" Y="442" T="12" P="1,0" /><P X="2033" Y="264" T="12" P="1,0" /><P X="2165" Y="1129" T="1" P="1,0" /><P X="866" Y="750" T="11" P="1,0" /><P X="1529" Y="1105" T="11" P="1,0" /><P X="1853" Y="1791" T="11" P="1,0" /><P X="2583" Y="2234" T="11" P="1,0" /><P X="2047" Y="2575" T="3" P="1,0" /><P X="1073" Y="254" T="3" P="1,0" /><P X="202" Y="290" T="1" P="1,0" /><P X="1420" Y="200" T="1" P="1,0" /><P X="2515" Y="523" T="1" P="1,0" /><P X="216" Y="2565" T="5" P="1,0" /><P X="253" Y="1372" T="84" P="1,0" /><P X="467" Y="1129" T="84" P="1,0" /><P X="1794" Y="1223" T="84" P="1,0" /><P X="1919" Y="1526" T="84" P="1,0" /><P C="4b8e72" Y="1248" T="85" X="330" P="1,0" /><P C="4b8e72" Y="1356" T="85" X="1831" P="1,0" /><P X="1614" Y="2906" T="2" P="1,0" /><P X="2819" Y="1893" T="12" P="1,0" /><P X="2903" Y="2549" T="12" P="1,0" /><P X="1198" Y="2943" T="1" P="1,0" /><P X="191" Y="2928" T="1" P="1,0" /><P X="2845" Y="1431" T="1" P="1,0" /><P X="2210" Y="729" T="3" P="1,0" /><P X="106" Y="558" T="3" P="1,0" /><P X="182" Y="1686" T="3" P="1,0" /><P X="733" Y="2448" T="3" P="1,0" /><P X="2263" Y="2499" T="11" P="1,0" /><DS Y="1500" X="1500" /></D><O /><L><JP M1="9" AXIS="1,0" MV="Infinity,-0.3" /><JP M1="11" AXIS="1,0" MV="Infinity,0.3" /><JP M1="7" AXIS="0,1" MV="Infinity,-0.3" /><JP M1="5" AXIS="0,1" MV="Infinity,0.3" /><JP M1="67" AXIS="1,0" MV="Infinity,-0.3" /><JP M1="69" AXIS="1,0" MV="Infinity,0.3" /><JP M1="70" AXIS="0,1" MV="Infinity,-0.3" /><JP M1="68" AXIS="0,1" MV="Infinity,0.3" /></L></Z></C>',
     '<C><P reload="true" L="3000" MEDATA=";19,1;;;-0;0::0,1,2,3,4,5,6,7:1-" G="0,0" H="3000" bh="" segments="nogravmove" /><Z><S><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="26af2f" X="1500" c="4" Y="1500" T="12" H="3000" /><S P="0,0,0.3,0.2,90,0,0,0" L="3000" o="2b9732" X="1500" c="3" Y="-1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="-1500" c="3" Y="1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="4500" c="3" Y="1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="1500" c="3" Y="4500" T="12" H="3000" /><S P="1,999999,0.3,0,0,0,0,0" L="3000" X="1500" c="3" Y="3220" T="19" m="" H="40" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="-1500" Y="4500" T="12" H="3000" /><S P="1,999999,0.3,0,0,0,0,0" L="3000" X="1500" c="3" Y="-220" T="19" m="" H="40" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="4500" Y="4500" T="12" H="3000" /><S P="1,999999,0.3,0,0,0,0,0" L="40" X="-220" c="3" Y="1500" T="19" m="" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="4500" Y="-1500" T="12" H="3000" /><S P="1,999999,0.3,0,0,0,0,0" L="40" X="3220" c="3" Y="1500" T="19" m="" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="2b9732" X="-1500" Y="-1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="4500" c="3" Y="4500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="-1500" c="3" Y="4500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="4500" c="3" Y="-1500" T="12" H="3000" /><S P="0,0,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="-1500" c="3" Y="-1500" T="12" H="3000" /><S P="1,999999,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="-1700" c="3" N="" Y="1500" T="12" H="3000" /><S P="1,999999,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="1500" c="3" N="" Y="4700" T="12" H="3000" /><S P="1,999999,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="4700" c="3" N="" Y="1500" T="12" H="3000" /><S P="1,999999,0.3,0.2,0,0,0,0" L="3000" o="C22626" X="1500" c="3" N="" Y="-1700" T="12" H="3000" /><S P="0,0,0.3,0,0,0,0,0" L="200" X="1500" c="3" Y="1100" T="19" H="40" /><S P="0,0,0.3,0,0,0,0,0" L="200" X="700" c="3" Y="700" T="19" H="200" /><S P="0,0,0.3,0,0,0,0,0" L="200" X="700" c="3" Y="2300" T="19" H="200" /><S P="0,0,0.3,0,0,0,0,0" L="200" X="2300" c="3" Y="2300" T="19" H="200" /><S P="0,0,0.3,0,0,0,0,0" L="200" X="2300" c="3" Y="700" T="19" H="200" /><S P="0,0,0.3,0,0,0,0,0" L="200" X="1500" c="3" Y="300" T="19" H="40" /><S P="0,0,0.3,0,180,0,0,0" L="200" X="1500" c="3" Y="1900" T="19" H="40" /><S P="0,0,0.3,0,180,0,0,0" L="200" X="1500" c="3" Y="2700" T="19" H="40" /><S P="0,0,0.3,0,90,0,0,0" L="200" X="1900" c="3" Y="1500" T="19" H="40" /><S P="0,0,0.3,0,90,0,0,0" L="200" X="2700" c="3" Y="1500" T="19" H="40" /><S P="0,0,0.3,0,-90,0,0,0" L="200" X="1100" c="3" Y="1500" T="19" H="40" /><S P="0,0,0.3,0,-90,0,0,0" L="200" X="300" c="3" Y="1500" T="19" H="40" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1DC525" H="10" Y="1500" T="13" X="2300" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1DC525" H="10" Y="700" T="13" X="1500" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1DC525" H="10" Y="2300" T="13" X="1500" /><S P="0,0,0.3,0.2,0,0,0,0" L="100" o="1DC525" H="10" Y="1500" T="13" X="700" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="300" Y="300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="300" Y="1900" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1900" Y="1900" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1900" Y="300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="700" Y="300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="700" Y="1900" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2300" Y="1900" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2300" Y="300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1100" Y="300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1100" Y="1900" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2700" Y="1900" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2700" Y="300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="700" Y="1100" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="700" Y="2700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2300" Y="2700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2300" Y="1100" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1100" Y="1100" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1100" Y="2700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2700" Y="2700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2700" Y="1100" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="300" Y="1100" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="300" Y="2700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1900" Y="2700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1900" Y="1100" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1100" Y="700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1100" Y="2300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2700" Y="2300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="2700" Y="700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="300" Y="700" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="300" Y="2300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1900" Y="2300" T="12" H="200" /><S P="0,0,0.3,0.2,0,0,0,0" L="200" o="1C8321" X="1900" Y="700" T="12" H="200" /></S><D><P X="960" Y="1694" T="5" P="1,0" /><P X="1932" Y="2126" T="5" P="1,0" /><P X="872" Y="2530" T="5" P="1,0" /><P X="84" Y="2202" T="5" P="1,0" /><P X="456" Y="2890" T="5" P="1,0" /><P X="204" Y="1314" T="5" P="1,0" /><P X="784" Y="882" T="5" P="1,0" /><P X="2088" Y="1070" T="5" P="1,0" /><P X="2520" Y="1566" T="5" P="1,0" /><P X="2824" Y="2118" T="5" P="1,0" /><P X="2492" Y="2878" T="5" P="1,0" /><P X="1568" Y="2874" T="5" P="1,0" /><P X="1560" Y="1414" T="5" P="1,0" /><P X="1600" Y="570" T="5" P="1,0" /><P X="104" Y="506" T="5" P="1,0" /><P X="836" Y="126" T="5" P="1,0" /><P X="2464" Y="122" T="5" P="1,0" /><P X="2072" Y="322" T="5" P="1,0" /><P X="2800" Y="918" T="5" P="1,0" /><P X="2900" Y="434" T="5" P="1,0" /><DS Y="1500" X="1500" /></D><O /><L><JP AXIS="1,0" MV="Infinity,-0.3" M1="9" /><JP AXIS="1,0" MV="Infinity,0.3" M1="11" /><JP AXIS="0,1" MV="Infinity,-0.3" M1="7" /><JP AXIS="0,1" MV="Infinity,0.3" M1="5" /><JP AXIS="1,0" MV="Infinity,-0.3" M1="17" /><JP AXIS="1,0" MV="Infinity,0.3" M1="19" /><JP AXIS="0,1" MV="Infinity,-0.3" M1="20" /><JP AXIS="0,1" MV="Infinity,0.3" M1="18" /></L></Z></C>',
     '<C><P L="3000" H="3000" G="0,0" bh="" MEDATA="34,1;;;;-0;0::0,1,2,3,4,5,6,7:1-" reload="true" segments="nogravmove"/><Z><S><S T="12" X="1500" Y="1500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="26af2f" c="4"/><S T="12" X="1500" Y="-1500" L="3000" H="3000" P="0,0,0.3,0.2,90,0,0,0" o="2b9732" c="3"/><S T="12" X="-1500" Y="1500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="2b9732" c="3"/><S T="12" X="4500" Y="1500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="2b9732" c="3"/><S T="12" X="1500" Y="4500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="2b9732" c="3"/><S T="19" X="1500" Y="3220" L="3000" H="40" P="1,999999,0.3,0,0,0,0,0" c="3" m=""/><S T="12" X="-1500" Y="4500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="2b9732"/><S T="19" X="1500" Y="-220" L="3000" H="40" P="1,999999,0.3,0,0,0,0,0" c="3" m=""/><S T="12" X="4500" Y="4500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="2b9732"/><S T="19" X="-220" Y="1500" L="40" H="3000" P="1,999999,0.3,0,0,0,0,0" c="3" m=""/><S T="12" X="4500" Y="-1500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="2b9732"/><S T="19" X="3220" Y="1500" L="40" H="3000" P="1,999999,0.3,0,0,0,0,0" c="3" m=""/><S T="12" X="-1500" Y="-1500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="2b9732"/><S T="12" X="4500" Y="4500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="C22626" c="3"/><S T="12" X="-1500" Y="4500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="C22626" c="3"/><S T="12" X="4500" Y="-1500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="C22626" c="3"/><S T="12" X="-1500" Y="-1500" L="3000" H="3000" P="0,0,0.3,0.2,0,0,0,0" o="C22626" c="3"/><S T="12" X="-1700" Y="1500" L="3000" H="3000" P="1,999999,0.3,0.2,0,0,0,0" o="C22626" c="3" N=""/><S T="12" X="1500" Y="4700" L="3000" H="3000" P="1,999999,0.3,0.2,0,0,0,0" o="C22626" c="3" N=""/><S T="12" X="4700" Y="1500" L="3000" H="3000" P="1,999999,0.3,0.2,0,0,0,0" o="C22626" c="3" N=""/><S T="12" X="1500" Y="-1700" L="3000" H="3000" P="1,999999,0.3,0.2,0,0,0,0" o="C22626" c="3" N=""/><S T="12" X="1500" Y="1500" L="400" H="400" P="0,0,0.3,0.2,0,0,0,0" o="F5FF4A" c="4"/><S T="12" X="300" Y="1500" L="400" H="400" P="0,0,0.3,0.2,0,0,0,0" o="F5FF4A" c="4"/><S T="12" X="2700" Y="1500" L="400" H="400" P="0,0,0.3,0.2,0,0,0,0" o="F5FF4A" c="4"/><S T="12" X="1500" Y="300" L="400" H="400" P="0,0,0.3,0.2,0,0,0,0" o="F5FF4A" c="4"/><S T="12" X="1500" Y="2700" L="400" H="400" P="0,0,0.3,0.2,0,0,0,0" o="F5FF4A" c="4"/><S T="12" X="1500" Y="1500" L="2000" H="200" P="0,0,0.3,0.2,0,0,0,0" o="F5FF4A" c="4"/><S T="12" X="1500" Y="1500" L="2000" H="200" P="0,0,0.3,0.2,-90,0,0,0" o="F5FF4A" c="4"/><S T="12" X="2160" Y="1400" L="700" H="20" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1600" Y="850" L="720" H="20" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="1600" Y="2150" L="720" H="20" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="1400" Y="2150" L="720" H="20" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="1400" Y="850" L="720" H="20" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="840" Y="1400" L="700" H="20" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="2160" Y="1600" L="700" H="20" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="840" Y="1600" L="700" H="20" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="19" X="1320" Y="1670" L="40" H="40" P="0,0,0.3,0,0,0,0,0" c="3"/><S T="19" X="1680" Y="1670" L="40" H="40" P="0,0,0.3,0,0,0,0,0" c="3"/><S T="12" X="1700" Y="1650" L="20" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1300" Y="1650" L="20" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="500" Y="1650" L="20" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1650" Y="1690" L="20" H="120" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="19" X="1320" Y="1330" L="40" H="40" P="0,0,0.3,0,0,0,0,0" c="3"/><S T="19" X="1680" Y="1330" L="40" H="40" P="0,0,0.3,0,0,0,0,0" c="3"/><S T="12" X="1650" Y="1310" L="20" H="120" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="1350" Y="1310" L="20" H="120" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="1350" Y="1690" L="20" H="120" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="2500" Y="1650" L="20" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="2500" Y="1350" L="20" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1650" Y="500" L="20" H="100" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="1350" Y="500" L="20" H="100" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="2550" Y="1310" L="20" H="120" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="1690" Y="450" L="20" H="120" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1690" Y="170" L="20" H="120" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1310" Y="170" L="20" H="120" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1310" Y="450" L="20" H="120" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1350" Y="2500" L="20" H="100" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="1650" Y="2500" L="20" H="100" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="1690" Y="2850" L="20" H="120" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1690" Y="2552" L="20" H="120" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1310" Y="2550" L="20" H="120" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1310" Y="2850" L="20" H="120" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="2850" Y="1310" L="20" H="120" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="2850" Y="1690" L="20" H="120" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="2550" Y="1690" L="20" H="120" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="2900" Y="1500" L="20" H="400" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1500" Y="110" L="20" H="400" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="1500" Y="2900" L="20" H="400" P="0,0,0.3,0.2,90,0,0,0" o="FF8F00"/><S T="12" X="100" Y="1500" L="20" H="400" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1700" Y="1350" L="20" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="1300" Y="1350" L="20" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="500" Y="1350" L="20" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FF8F00"/><S T="12" X="450" Y="1310" L="20" H="120" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="450" Y="1690" L="20" H="120" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="150" Y="1690" L="20" H="120" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="150" Y="1310" L="20" H="120" P="0,0,0.3,0.2,-90,0,0,0" o="FF8F00"/><S T="12" X="2100" Y="900" L="600" H="600" P="0,0,0.3,0.2,0,0,0,0" o="0046FF" c="4"/><S T="12" X="900" Y="900" L="600" H="600" P="0,0,0.3,0.2,0,0,0,0" o="0046FF" c="4"/><S T="12" X="900" Y="2100" L="600" H="600" P="0,0,0.3,0.2,0,0,0,0" o="0046FF" c="4"/><S T="12" X="2100" Y="2100" L="600" H="600" P="0,0,0.3,0.2,0,0,0,0" o="0046FF" c="4"/><S T="19" X="1500" Y="2700" L="40" H="40" P="1,10000,0.3,0,0,0,0,0"/><S T="19" X="2700" Y="1500" L="40" H="40" P="1,10000,0.3,0,0,0,0,0"/><S T="19" X="300" Y="1500" L="40" H="40" P="1,10000,0.3,0,0,0,0,0"/><S T="19" X="1500" Y="300" L="40" H="40" P="1,10000,0.3,0,0,0,0,0"/><S T="19" X="2000" Y="2550" L="40" H="600" P="0,0,0.3,0,90,0,0,0" c="3"/><S T="19" X="1000" Y="2550" L="40" H="600" P="0,0,0.3,0,-90,0,0,0" c="3"/><S T="19" X="2550" Y="2000" L="40" H="600" P="0,0,0.3,0,180,0,0,0" c="3"/><S T="19" X="2550" Y="1000" L="40" H="600" P="0,0,0.3,0,360,0,0,0" c="3"/><S T="19" X="2000" Y="450" L="40" H="600" P="0,0,0.3,0,450,0,0,0" c="3"/><S T="19" X="1000" Y="450" L="40" H="600" P="0,0,0.3,0,270,0,0,0" c="3"/><S T="19" X="450" Y="1000" L="40" H="600" P="0,0,0.3,0,360,0,0,0" c="3"/><S T="19" X="450" Y="2000" L="40" H="600" P="0,0,0.3,0,180,0,0,0" c="3"/></S><D><P X="258" Y="383" T="1" P="1,0"/><P X="974" Y="329" T="1" P="1,0"/><P X="198" Y="1167" T="1" P="1,0"/><P X="196" Y="2071" T="1" P="1,0"/><P X="214" Y="2903" T="1" P="1,0"/><P X="996" Y="2929" T="1" P="1,0"/><P X="2158" Y="2913" T="1" P="1,0"/><P X="2780" Y="2917" T="1" P="1,0"/><P X="2794" Y="2191" T="1" P="1,0"/><P X="2794" Y="1087" T="1" P="1,0"/><P X="2002" Y="323" T="1" P="1,0"/><P X="2718" Y="379" T="1" P="1,0"/><P X="726" Y="557" T="0" P="1,0"/><P X="1148" Y="551" T="0" P="1,0"/><P X="1266" Y="1117" T="0" P="1,0"/><P X="1254" Y="695" T="0" P="1,0"/><P X="1680" Y="1069" T="0" P="1,0"/><P X="1684" Y="725" T="0" P="1,0"/><P X="1912" Y="1297" T="0" P="1,0"/><P X="2272" Y="1293" T="0" P="1,0"/><P X="2246" Y="1741" T="0" P="1,0"/><P X="1888" Y="1747" T="0" P="1,0"/><P X="1694" Y="2305" T="0" P="1,0"/><P X="2456" Y="2279" T="0" P="1,0"/><P X="2448" Y="1881" T="0" P="1,0"/><P X="2264" Y="2497" T="0" P="1,0"/><P X="1922" Y="2485" T="0" P="1,0"/><P X="1026" Y="2495" T="0" P="1,0"/><P X="1258" Y="2327" T="0" P="1,0"/><P X="1246" Y="1913" T="0" P="1,0"/><P X="1680" Y="1911" T="0" P="1,0"/><P X="520" Y="1975" T="0" P="1,0"/><P X="524" Y="2353" T="0" P="1,0"/><P X="706" Y="2481" T="0" P="1,0"/><P X="1032" Y="1753" T="0" P="1,0"/><P X="678" Y="1763" T="0" P="1,0"/><P X="2444" Y="1111" T="0" P="1,0"/><P X="2444" Y="739" T="0" P="1,0"/><P X="2248" Y="573" T="0" P="1,0"/><P X="1912" Y="577" T="0" P="1,0"/><P X="1080" Y="1315" T="0" P="1,0"/><P X="680" Y="1291" T="0" P="1,0"/><P X="518" Y="773" T="0" P="1,0"/><P X="520" Y="1125" T="0" P="1,0"/><DS X="1500" Y="1500"/></D><O/><L><JP M1="9" AXIS="1,0" MV="Infinity,-0.3"/><JP M1="11" AXIS="1,0" MV="Infinity,0.3"/><JP M1="7" AXIS="0,1" MV="Infinity,-0.3"/><JP M1="5" AXIS="0,1" MV="Infinity,0.3"/><JP M1="17" AXIS="1,0" MV="Infinity,-0.3"/><JP M1="19" AXIS="1,0" MV="Infinity,0.3"/><JP M1="20" AXIS="0,1" MV="Infinity,-0.3"/><JP M1="18" AXIS="0,1" MV="Infinity,0.3"/></L></Z></C>'}
local gameStarted, firstRun, newPlayer, bonusTime, countDownTime, countDown, keys = false, true, false, 0, 0, 10,
    {0, 1, 2, 3, 32, 69, 80}
local textAreaIds = {
    countDown = 96,
    aliveMice = 97,
    shopArea = 98,
    shopUiArea = {
        money = 1001,
        [1] = 1002,
        [2] = 1003,
        [3] = 1004,
        [4] = 1005,
        [5] = 1006,
        [6] = 1007
    },
    gift = {
        backGround = 100,
        onImg = 101
    }
}
local cannon = {
    price = {
        normal = "[FREE]",
        golden = 500,
        orange = 200,
        silver = 100,
        bear = 300,
        hamburger = 400
    },
    normal = "163e2f4401c.png",
    golden = "163e2ef7cfb.png",
    orange = "1655eb6443a.png",
    silver = "1655e6ce8f9.png",
    bear = "16b274484fb.png",
    hamburger = "16837dde712.png"
}
local spawnPoints = {{{
    x = 779,
    y = 301
}, {
    x = 500,
    y = 1000
}, {
    x = 1375,
    y = 650
}, {
    x = 1637,
    y = 652
}, {
    x = 2476,
    y = 506
}, {
    x = 2540,
    y = 1497
}, {
    x = 2012,
    y = 2584
}, {
    x = 2880,
    y = 2365
}, {
    x = 300,
    y = 2800
}, {
    x = 1500,
    y = 1800
}}, {{
    x = 953,
    y = 123
}, {
    x = 2109,
    y = 520
}, {
    x = 503,
    y = 1092
}, {
    x = 1706,
    y = 1680
}, {
    x = 1278,
    y = 711
}, {
    x = 2153,
    y = 2505
}, {
    x = 500,
    y = 2133
}, {
    x = 1322,
    y = 2567
}, {
    x = 2531,
    y = 1355
}, {
    x = 703,
    y = 2898
}}, {{
    x = 900,
    y = 900
}, {
    x = 2100,
    y = 900
}, {
    x = 2100,
    y = 1500
}, {
    x = 2700,
    y = 2500
}, {
    x = 300,
    y = 500
}, {
    x = 900,
    y = 1500
}, {
    x = 2100,
    y = 2100
}, {
    x = 900,
    y = 2100
}, {
    x = 1500,
    y = 2100
}, {
    x = 1500,
    y = 900
}}}

for _, i in next, {'AutoShaman', 'MinimalistMode', 'WatchCommand', 'MortCommand', 'AutoNewGame', 'AutoScore',
                   'PhysicalConsumables'} do
    tfm.exec["disable" .. i]()
end
system.disableChatCommandDisplay(nil, true)
tfm.exec.newGame(maps[1])

eventNewPlayer = function(name)
    players[name] = {
        coin = 0,
        playing = false,
        cooldown = 1,
        speed = 50,
        lastObj,
        secondObj,
        thirdObj,
        obj = {
            id = 17,
            offset = 30,
            speed = 0,
            count = 1,
            img = false
        },
        event = {
            img,
            hasBarrier = false,
            barrierId,
            barrierPutted = false,
            playerSize = 1
        },
        inventory = {true, false, false, false, false, false},
        imgs = {aliveMice, shopImg, shopUiImg, shopMoneyImg},
        inShop = {},
        bag = {
            silver = false,
            orange = false,
            bear = false,
            hamburger = false,
            golden = false
        },
        ui = {
            shopOpened = false
        }
    }
    if not firstRun then
        addShopImg(name, 775, 50)
    end
    system.bindMouse(name, true)
    tfm.exec.setPlayerScore(name, 0, false)
    for i = 1, #keys do
        system.bindKeyboard(name, keys[i], true, true)
        system.bindKeyboard(name, keys[i], false, true)
    end
    if not gameStarted then
        tfm.exec.respawnPlayer(name)
        local barrierPuttedId = 1
        for name in next, players do
            players[name].event.barrierId = barrierPuttedId
            barrierPuttedId = barrierPuttedId + 1
        end
    else
        updatePlaying(name)
        newPlayer = true
    end
end

for name in next, tfm.get.room.playerList do
    eventNewPlayer(name)
end
firstRun = false

eventPlayerLeft = function(name)
    players[name].playing = false
end

eventNewGame = function()
    if gameStarted then
        tfm.exec.disableAfkDeath(false)
        bonusTime = 0
        countDownTime = 0
        countDown = 10
        ui.removeTextArea(1)
        addBonus()
        for name in next, players do
            updatePlaying(name)
            if players[name].playing then
                local i = math.random(#spawnPoints[mapPlaying])
                tfm.exec
                    .movePlayer(name, spawnPoints[mapPlaying][i].x, spawnPoints[mapPlaying][i].y, false, 0, 0, false)
                removeShopImg(name)
                if players[name].ui.shopOpened then
                    removeShop(name)
                    players[name].ui.shopOpened = false
                end
            end
        end
    else
        tfm.exec.disableAfkDeath()
        bonus = {}
        for _, i in next, textAreaIds.gift do
            ui.removeTextArea(i)
        end
        ui.removeTextArea(textAreaIds.aliveMice)
        for name in next, players do
            if players[name].event.img then
                tfm.exec.removeImage(players[name].event.img)
            end
            if players[name].imgs.aliveMice then
                tfm.exec.removeImage(players[name].imgs.aliveMice)
            end
            players[name] = {
                coin = players[name].coin,
                playing = false,
                cooldown = 1,
                speed = 50,
                lastObj,
                secondObj,
                thirdObj,
                obj = {
                    id = players[name].obj.id,
                    offset = players[name].obj.offset,
                    speed = 0,
                    count = 1,
                    img = players[name].obj.img
                },
                event = {
                    img,
                    hasBarrier = false,
                    barrierId = players[name].event.barrierId,
                    barrierPutted = false,
                    playerSize = 1
                },
                inventory = {players[name].inventory[1], players[name].inventory[2], players[name].inventory[3],
                             players[name].inventory[4], players[name].inventory[5], players[name].inventory[6]},
                imgs = {aliveMice, shopImg, shopUiImg, shopMoneyImg},
                inShop = {},
                bag = {
                    silver = players[name].bag.silver,
                    orange = players[name].bag.orange,
                    bear = players[name].bag.bear,
                    hamburger = players[name].bag.hamburger,
                    golden = players[name].bag.golden
                },
                ui = {
                    shopOpened = false
                }
            }
            addShopImg(name, 775, 50)
            tfm.exec.changePlayerSize(name, 1)
        end
        if newPlayer then
            local barrierPuttedId = 1
            for name in next, players do
                players[name].event.barrierId = barrierPuttedId
                barrierPuttedId = barrierPuttedId + 1
            end
        end
    end
end

eventPlayerDied = function(name)
    if gameStarted then
        players[name].playing = false
        if getPlaying() == 1 then
            tfm.exec.newGame(maps[1])
            for name in next, players do
                if players[name].playing then
                    tfm.exec.setPlayerScore(name, 10, true)
                    ui.addTextArea(1,
                        "<p align='center'><font size='22'><font color='#FFFFFF'>Kazanan </font><font color='#FF0000'>" ..
                            name .. "</font><font color='#FFFFFF'> !</font></font></p>", nil, 0, 30, 800, 45, nil, nil,
                        0, true)
                    players[name].playing = false
                    players[name].coin = players[name].coin + 10
                end
            end
            gameStarted = false
        else
            for name in next, players do
                updatePlaying(name)
            end
        end
    end
end

eventChatCommand = function(name, cmd)
    if admins[name] then
        local arg = {}
        for nick in cmd:gmatch("[^%s]+") do
            arg[#arg + 1] = nick
        end
        for numbers in cmd:gmatch("^%s%d$") do
            arg[#arg + 1] = numbers
        end
        if arg[1] == "a" then
            gameStarted = true
            for name in next, tfm.get.room.playerList do
                if not tfm.get.room.playerList[name].isDead then
                    players[name].playing = true
                end
            end
            local i = math.random(2, 4)
            mapPlaying = i - 1
            tfm.exec.newGame(maps[i])
        elseif arg[1] == "b" then
            gameStarted = false
            tfm.exec.newGame(maps[1])
        elseif arg[1] == "money" and players[arg[2]] then
            if arg[3] then
                decreaseCoin(arg[2], -(arg[3]))
            else
                decreaseCoin(arg[2], -1000)
            end
            if players[name].ui.shopOpened then
                removeShop(name)
                displayShop(name)
            end
        end
    end
end
eventMouse = function(name, x, y)
    if admins[name] then
        players[name].lastObj = tfm.exec.addShamanObject(players[name].obj.id, players[name][3] == 0 and x -
                                    players[name].obj.offset or x + players[name].obj.offset, y,
                                    players[name][3] == 0 and -90 or 90)
        if players[name].obj.img then
            tfm.exec.addImage(players[name].obj.img, "#" .. players[name].lastObj, -17.5, -16)
        end
    end
end

eventKeyboard = function(name, key, down, x, y)
    if gameStarted then
        if key == 1 then
            if down then
                tfm.exec.movePlayer(name, 0, 0, false, 0, -players[name].speed, false)
            else
                tfm.exec.movePlayer(name, 0, 0, false, 0, -1, false)
                tfm.exec.movePlayer(name, 0, 0, false, 0, 1, true)
            end

        elseif key == 3 then
            if down then
                tfm.exec.movePlayer(name, 0, 0, false, 0, players[name].speed, false)
            else
                tfm.exec.movePlayer(name, 0, 0, false, 0, -1, false)
                tfm.exec.movePlayer(name, 0, 0, false, 0, 1, true)
            end

        elseif key == 0 then
            if down then
                tfm.exec.movePlayer(name, 0, 0, false, -players[name].speed + 5, 0, false)
            else
                tfm.exec.movePlayer(name, 0, 0, false, -1, 0, false)
                tfm.exec.movePlayer(name, 0, 0, false, 1, 0, true)
            end

        elseif key == 2 then
            if down then
                tfm.exec.movePlayer(name, 0, 0, false, players[name].speed - 5, 0, false)
            else
                tfm.exec.movePlayer(name, 0, 0, false, -1, 0, false)
                tfm.exec.movePlayer(name, 0, 0, false, 1, 0, true)
            end
        end
    else
        if key == 80 then
            print(getClosestPlayerTo(name))
        end
    end
    if key == 0 or key == 1 or key == 2 or key == 3 then
        if down then
            players[name][3] = key
        end
    end
    if players[name].playing and key == 32 then
        if players[name].cooldown == 0 then
            if players[name].lastObj then
                tfm.exec.removeObject(players[name].lastObj)
            end
            if players[name].secondObj then
                tfm.exec.removeObject(players[name].secondObj)
            end
            if players[name].thirdObj then
                tfm.exec.removeObject(players[name].thirdObj)
            end
            if players[name].event.barrierPutted then
                tfm.exec.removePhysicObject(players[name].event.barrierId)
                players[name].event.barrierPutted = false
            end
            if players[name][3] == 0 or players[name][3] == 2 then
                if players[name].obj.count == 1 then
                    players[name].lastObj = tfm.exec.addShamanObject(players[name].obj.id,
                                                players[name][3] == 0 and x - players[name].obj.offset or x +
                                                    players[name].obj.offset, y, players[name][3] == 0 and -90 or 90)
                    if players[name].obj.img then
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].lastObj, -17.5, -16)
                    end
                elseif players[name].obj.count == 2 then
                    players[name].lastObj = tfm.exec.addShamanObject(players[name].obj.id,
                                                players[name][3] == 0 and x - players[name].obj.offset or x +
                                                    players[name].obj.offset, y + 15,
                                                players[name][3] == 0 and -90 or 90)
                    players[name].secondObj = tfm.exec.addShamanObject(players[name].obj.id,
                                                  players[name][3] == 0 and x - players[name].obj.offset or x +
                                                      players[name].obj.offset, y - 15,
                                                  players[name][3] == 0 and -90 or 90)
                    if players[name].obj.img then
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].lastObj, -17.5, -16)
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].secondObj, -17.5, -16)
                    end
                elseif players[name].obj.count == 3 then
                    players[name].lastObj = tfm.exec.addShamanObject(players[name].obj.id,
                                                players[name][3] == 0 and x - players[name].obj.offset or x +
                                                    players[name].obj.offset, y + 30,
                                                players[name][3] == 0 and -90 or 90)
                    players[name].secondObj = tfm.exec.addShamanObject(players[name].obj.id,
                                                  players[name][3] == 0 and x - players[name].obj.offset or x +
                                                      players[name].obj.offset, y, players[name][3] == 0 and -90 or 90)
                    players[name].thirdObj = tfm.exec.addShamanObject(players[name].obj.id,
                                                 players[name][3] == 0 and x - players[name].obj.offset or x +
                                                     players[name].obj.offset, y - 30,
                                                 players[name][3] == 0 and -90 or 90)
                    if players[name].obj.img then
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].lastObj, -17.5, -16)
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].secondObj, -17.5, -16)
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].thirdObj, -17.5, -16)
                    end

                end
            else
                if players[name].obj.count == 1 then
                    players[name].lastObj = tfm.exec.addShamanObject(players[name].obj.id, x, players[name][3] == 1 and
                                                y - players[name].obj.offset or y + players[name].obj.offset,
                                                players[name][3] == 1 and 0 or 180)
                    if players[name].obj.img then
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].lastObj, -17.5, -16)
                    end
                elseif players[name].obj.count == 2 then
                    players[name].lastObj = tfm.exec.addShamanObject(players[name].obj.id, x + 15,
                                                players[name][3] == 1 and y - players[name].obj.offset or y +
                                                    players[name].obj.offset, players[name][3] == 1 and 0 or 180)
                    players[name].secondObj = tfm.exec.addShamanObject(players[name].obj.id, x - 15,
                                                  players[name][3] == 1 and y - players[name].obj.offset or y +
                                                      players[name].obj.offset, players[name][3] == 1 and 0 or 180)
                    if players[name].obj.img then
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].lastObj, -17.5, -16)
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].secondObj, -17.5, -16)
                    end
                elseif players[name].obj.count == 3 then
                    players[name].lastObj = tfm.exec.addShamanObject(players[name].obj.id, x + 30,
                                                players[name][3] == 1 and y - players[name].obj.offset or y +
                                                    players[name].obj.offset, players[name][3] == 1 and 0 or 180)
                    players[name].secondObj = tfm.exec.addShamanObject(players[name].obj.id, x,
                                                  players[name][3] == 1 and y - players[name].obj.offset or y +
                                                      players[name].obj.offset, players[name][3] == 1 and 0 or 180)
                    players[name].thirdObj = tfm.exec.addShamanObject(players[name].obj.id, x - 30, players[name][3] ==
                                                 1 and y - players[name].obj.offset or y + players[name].obj.offset,
                                                 players[name][3] == 1 and 0 or 180)
                    if players[name].obj.img then
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].lastObj, -17.5, -16)
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].secondObj, -17.5, -16)
                        tfm.exec.addImage(players[name].obj.img, "#" .. players[name].thirdObj, -17.5, -16)
                    end
                end
            end
            players[name].cooldown = 4
        end
    elseif key == 69 then
        if players[name].event.hasBarrier then
            if players[name][3] == 0 or players[name][3] == 2 then
                players[name].event.barrierPutted = tfm.exec.addPhysicObject(players[name].event.barrierId,
                                                        players[name][3] == 0 and x - players[name].obj.offset or x +
                                                            players[name].obj.offset, y, {
                        height = 75
                    })
                tfm.exec.displayParticle(3, players[name][3] == 0 and x - players[name].obj.offset or x +
                    players[name].obj.offset, y, 0, 0, 0, 0, nil)
            else
                players[name].event.barrierPutted = tfm.exec.addPhysicObject(players[name].event.barrierId, x,
                                                        players[name][3] == 1 and y - players[name].obj.offset or y +
                                                            players[name].obj.offset, {
                        width = 75
                    })
                tfm.exec.displayParticle(3, x, players[name][3] == 1 and y - players[name].obj.offset or y +
                    players[name].obj.offset, 0, 0, 0, 0, nil)
            end
            players[name].event.hasBarrier = false
            players[name].event.barrierPutted = true
            tfm.exec.removeImage(players[name].event.img)
            ui.removeTextArea(textAreaIds.gift.backGround, name)
            ui.removeTextArea(textAreaIds.gift.onImg, name)
        end
    end
end

eventLoop = function(a, b)
    if gameStarted then
        if a <= 12000 then
            countDownTime = countDownTime + 1
            if countDownTime >= 2 then
                if countDown > 0 then
                    ui.addTextArea(textAreaIds.countDown,
                        "\n\n\n\n\n\n<p align='center'><font size='100'><font color='#FF0000'>" .. countDown ..
                            "</font></font></p>", nil, 0, 0, 800, 400, nil, nil, 0, true)
                else
                    ui.addTextArea(textAreaIds.countDown,
                        "\n\n\n\n\n\n<p align='center'><font size='100'><font color='#FF0000'>GO</font></font></p>",
                        nil, 0, 0, 800, 400, nil, nil, 0, true)
                end
                countDown = countDown - 1
                countDownTime = 0
            end
        elseif a >= 9500 then
            ui.removeTextArea(textAreaIds.countDown)
            for name in next, players do
                if players[name].cooldown > 0 then
                    players[name].cooldown = players[name].cooldown - 1
                end
            end
            bonusTime = bonusTime + 1
            if bonusTime == 1 then
                addBonus()
                bonusTime = 0
            end
        end
    end
end

eventPlayerBonusGrabbed = function(name, id)
    tfm.exec.removeImage(bonus[id].img)
    tfm.exec.removeBonus(id, nil)
    local event = math.random(1, 10)
    if event == 1 then
        if players[name].speed < 90 then
            players[name].speed = players[name].speed + 10
        else
            players[name].speed = players[name].speed - 10
            event = 2
        end
    elseif event == 2 then
        if players[name].speed > 10 then
            players[name].speed = players[name].speed - 10
        else
            players[name].speed = players[name].speed + 10
            event = 1
        end
    elseif event == 3 then
        local a = tfm.exec.addShamanObject(players[name].obj.id, bonus[id].x, bonus[id].y - 30, 0)
        local b = tfm.exec.addShamanObject(players[name].obj.id, bonus[id].x - 30, bonus[id].y, -90)
        local c = tfm.exec.addShamanObject(players[name].obj.id, bonus[id].x + 30, bonus[id].y, 90)
        local d = tfm.exec.addShamanObject(players[name].obj.id, bonus[id].x, bonus[id].y + 30, 180)
        if players[name].obj.img then
            for _, i in next, {a, b, c, d} do
                tfm.exec.addImage(players[name].obj.img, "#" .. i, -17.5, -16)
            end
        end
    elseif event == 4 then
        local count
        repeat
            count = math.random(1, 3)
        until (count ~= players[name].obj.count)
        players[name].obj.count = count
    elseif event == 5 then
        tfm.exec.explosion(bonus[id].x, bonus[id].y, 40, 20, true)
        tfm.exec.displayParticle(3, bonus[id].x, bonus[id].y, 0, 0, 0, 0, nil)
    elseif event == 6 then
        players[name].event.hasBarrier = true
    elseif event == 7 then
        if players[name].event.playerSize < 2 then
            players[name].event.playerSize = players[name].event.playerSize + 0.1
        else
            players[name].event.playerSize = players[name].event.playerSize - 0.1
            event = 8
        end
        tfm.exec.addShamanObject(0, bonus[id].x, bonus[id].y, event == 8 and 0 or 180, 0, 0, false)
        tfm.exec.changePlayerSize(name, players[name].event.playerSize)
    elseif event == 8 then
        if players[name].event.playerSize > 0 then
            players[name].event.playerSize = players[name].event.playerSize - 0.1
        else
            tfm.exec.changePlayerSize(name, players[name].event.playerSize + 0.1)
            event = 7
        end
        tfm.exec.addShamanObject(0, bonus[id].x, bonus[id].y, event == 8 and 0 or 180, 0, 0, false)
        tfm.exec.changePlayerSize(name, players[name].event.playerSize)
    elseif event == 9 then
        if tfm.get.room.playerList[name].hasCheese then
            tfm.exec.removeCheese(name)
        else
            tfm.exec.giveCheese(name)
        end
    elseif event == 10 then
        local i = math.random(1, 2)
        players[name].coin = players[name].coin + i
        tfm.exec.setPlayerScore(name, players[name].coin, false)
    elseif event == 100 then
        local degree
        if getClosestPlayerTo(name, 1) then -- working fine
            degree = math.deg(math.atan(getClosestPlayerTo(name, "y") / getClosestPlayerTo(name, "x"))) + 90
        elseif getClosestPlayerTo(name, 2) then
            degree = math.deg(math.atan(getClosestPlayerTo(name, "y") / getClosestPlayerTo(name, "x")) + 90)
        elseif getClosestPlayerTo(name, 3) then
            degree = math.deg(math.atan(getClosestPlayerTo(name, "y") / getClosestPlayerTo(name, "x")) + 90)
        elseif getClosestPlayerTo(name, 4) then -- working fine
            degree = math.deg(math.atan(getClosestPlayerTo(name, "y") / getClosestPlayerTo(name, "x"))) + 90
        end
        tfm.exec.addShamanObject(players[name].obj.id, tfm.get.room.playerList[name].x, tfm.get.room.playerList[name].y,
            degree)
    end
    addBonusImg(event, name)
end

-------------------------------------------------

getPlaying = function()
    local i = 0
    for name in next, players do
        if players[name].playing then
            i = i + 1
        end
    end
    return i
end

addBonus = function()
    local i, j = math.random(50, 2950), math.random(50, 2950)
    tfm.exec.addBonus(0, i, j, #bonus + 1, 0, false, nil)
    bonus[#bonus + 1] = {
        x = i,
        y = j,
        img = tfm.exec.addImage("16f1a0c1c4e.png", "!0", i - 32, j - 35, nil, 1.25, 1.25, 0, nil, nil, nil)
    }
end

addBonusImg = function(event, name)
    if players[name].event.img then
        tfm.exec.removeImage(players[name].event.img)
    end
    ui.removeTextArea(textAreaIds.gift.onImg, name)
    local borderColor = event == 1 and 0x00AABB or event == 2 and 0xFF0000 or event == 3 and 0xE08800 or event == 6 and
                            0xE08800 or event == 7 and 0x00AABB or event == 8 and 0xFF0000 or 0x000000
    ui.addTextArea(textAreaIds.gift.backGround, "", name, 740, 340, 50, 50, 0xFFDDAA, borderColor, 1, true)
    if event == 1 or event == 2 then
        local color = event == 1 and '#00AABB' or '#FF0000'
        players[name].event.img = tfm.exec.addImage("16fe31c49aa.png", "&100", 765, 365, name, 1, 1,
                                      math.rad(event == 1 and 0 or 180), 1, 0.5, 0.5)
        ui.addTextArea(textAreaIds.gift.onImg,
            "\n\n<p align ='right'><font size='9'><font color ='" .. color .. "'>" .. players[name].speed ..
                "</font></font></p>", name, 745, 354, 50, 50, nil, nil, 0, true)
    elseif event == 3 then
        players[name].event.img = tfm.exec.addImage("16fe31c8ffd.png", "&100", 765, 365, name, 1, 1, math.rad(0), 1,
                                      0.5, 0.5)
    elseif event == 4 then
        players[name].event.img = tfm.exec.addImage("1752b1c10bc.png", "&100", 765, 363, name, 1.05, 1.05, math.rad(0),
                                      1, 0.5, 0.5)
        ui.addTextArea(textAreaIds.gift.onImg,
            "\n\n<p align ='right'><font color ='#ff0000'>x" .. players[name].obj.count .. "</font></p>", name, 740,
            348, 50, 50, nil, nil, 0, true)
    elseif event == 5 then
        players[name].event.img = tfm.exec.addImage("16fe31c611b.png", "&100", 765, 365, name, 1.1, 1.1, math.rad(0), 1,
                                      0.5, 0.5)
    elseif event == 6 then
        players[name].event.img = tfm.exec.addImage("16fe31c0355.png", "&100", 765, 365, name, 1.1, 1.1, math.rad(0), 1,
                                      0.5, 0.5)
    elseif event == 7 or event == 8 then
        local color = event == 7 and '#00AABB' or '#FF0000'
        players[name].event.img = tfm.exec.addImage("16d67f42439.png", "&100", 765, 365, name, 1, 1,
                                      math.rad(event == 7 and 180 or 0), 1, 0.5, 0.5)
        ui.addTextArea(textAreaIds.gift.onImg, "\n\n<p align ='right'><font color ='" .. color .. "'>" ..
            players[name].event.playerSize .. "</font></p>", name, 745, 348, 50, 50, nil, nil, 0, true)
    elseif event == 9 then
        players[name].event.img = tfm.exec.addImage("168c3845081.png", "&100", 765, 362, name, 1, 1, math.rad(0), 1,
                                      0.5, 0.5)
        local i = not tfm.get.room.playerList[name].hasCheese and '&#10003;' or 'X'
        local color = not tfm.get.room.playerList[name].hasCheese and '#00AABB' or '#FF0000'
        ui.addTextArea(textAreaIds.gift.onImg,
            "\n\n<p align ='right'><font color='" .. color .. "'>" .. i .. "</font></p>", name, 745, 348, 50, 50, nil,
            nil, 0, true)
    elseif event == 10 then
        players[name].event.img = tfm.exec.addImage("166e9893b89.png", "&100", 765, 365, name, 1, 1, math.rad(0), 1,
                                      0.5, 0.5)
    end
end

updatePlaying = function(name)
    local color = getPlaying() > 5 and '#008000' or getPlaying() > 3 and '#00AABB' or '#FF0000'
    if players[name].imgs.aliveMice then
        tfm.exec.removeImage(players[name].imgs.aliveMice)
    end
    ui.addTextArea(textAreaIds.aliveMice, "<p align='right'><font size='25'><font color='" .. color .. "'>" ..
        getPlaying() .. "</font></font></p>", name, 20, 350, 70, 40, 0xFFDDAA, 0x000000, 1, true)
    players[name].imgs.aliveMice = tfm.exec.addImage("16e4ccf289d.png", "&100", 10, 342, name, 0.25, 0.25)
end

getPlayerPos = function(name)
    local i = 0
    for iname in next, players do
        i = i + 1
        if iname == name then
            return i
        end
    end
end

getClosestPlayerTo = function(name, type)
    local list = {}
    if getPlaying() > 1 then
        for iname in next, players do
            if name ~= iname then
                if players[iname].playing then
                    table.insert(list, iname)
                    list[#list] = {((tfm.get.room.playerList[name].x - tfm.get.room.playerList[iname].x) ^ 2 +
                        (tfm.get.room.playerList[name].y - tfm.get.room.playerList[iname].y) ^ 2) ^ 0.5, iname,
                                   tfm.get.room.playerList[iname].x - tfm.get.room.playerList[name].x,
                                   tfm.get.room.playerList[iname].y - tfm.get.room.playerList[name].y}
                end
            end
        end
        local tempLocation = list[1]
        for i = 1, #list do
            if list[i][1] < tempLocation[1] then
                tempLocation = list[i]
            end
        end
        local firstArea = false
        local secondArea = false
        local thirdArea = false
        local fourthArea = false

        if tfm.get.room.playerList[name].x <= tfm.get.room.playerList[tempLocation[2]].x and
            tfm.get.room.playerList[name].y >= tfm.get.room.playerList[tempLocation[2]].y then
            firstArea = true
        elseif tfm.get.room.playerList[name].x >= tfm.get.room.playerList[tempLocation[2]].x and
            tfm.get.room.playerList[name].y >= tfm.get.room.playerList[tempLocation[2]].y then
            secondArea = true
        elseif tfm.get.room.playerList[name].x >= tfm.get.room.playerList[tempLocation[2]].x and
            tfm.get.room.playerList[name].y <= tfm.get.room.playerList[tempLocation[2]].y then
            thirdArea = true
        elseif tfm.get.room.playerList[name].x <= tfm.get.room.playerList[tempLocation[2]].x and
            tfm.get.room.playerList[name].y <= tfm.get.room.playerList[tempLocation[2]].y then
            fourthArea = true
        end

        if type == "nick" then
            return tempLocation[2]
        elseif type == "x" then
            return tempLocation[3]
        elseif type == "y" then
            return tempLocation[4]
        elseif type == 1 then
            return firstArea
        elseif type == 2 then
            return secondArea
        elseif type == 3 then
            return thirdArea
        elseif type == 4 then
            return fourthArea
        end
    end
end

eventTextAreaCallback = function(id, name, event)
    if event == "shopEvent" then
        if players[name].ui.shopOpened then
            players[name].ui.shopOpened = false
            removeShop(name)
        else
            players[name].ui.shopOpened = true
            displayShop(name)
        end
    elseif event == "drag1" then
        players[name].inventory[1] = true
        players[name].obj.img = false
    elseif event == "drag2" then
        if players[name].bag.silver then
            players[name].bag["silver"] = true
            players[name].inventory[2] = true
            players[name].obj.img = cannon.silver
        else
            if players[name].coin >= cannon.price.silver then
                players[name].bag["silver"] = true
                players[name].inventory[2] = true
                players[name].obj.img = cannon.silver
                decreaseCoin(name, cannon.price.silver)
            end
        end
    elseif event == "drag3" then
        if players[name].bag.orange then
            players[name].bag["orange"] = true
            players[name].inventory[3] = true
            players[name].obj.img = cannon.orange
        else
            if players[name].coin >= cannon.price.orange then
                players[name].bag["orange"] = true
                players[name].inventory[3] = true
                players[name].obj.img = cannon.orange
                decreaseCoin(name, cannon.price.orange)
            end
        end
    elseif event == "drag4" then
        if players[name].bag.bear then
            players[name].bag["bear"] = true
            players[name].inventory[4] = true
            players[name].obj.img = cannon.bear
        else
            if players[name].coin >= cannon.price.bear then
                players[name].bag["bear"] = true
                players[name].inventory[4] = true
                players[name].obj.img = cannon.bear
                decreaseCoin(name, cannon.price.bear)
            end
        end
    elseif event == "drag5" then
        if players[name].bag.hamburger then
            players[name].bag["hamburger"] = true
            players[name].inventory[5] = true
            players[name].obj.img = cannon.hamburger
        else
            if players[name].coin >= cannon.price.hamburger then
                players[name].bag["hamburger"] = true
                players[name].inventory[5] = true
                players[name].obj.img = cannon.hamburger
                decreaseCoin(name, cannon.price.hamburger)
            end
        end
    elseif event == "drag6" then
        if players[name].bag.golden then
            players[name].bag["golden"] = true
            players[name].inventory[1] = true
            players[name].obj.img = cannon.golden
        else
            if players[name].coin >= cannon.price.golden then
                players[name].bag["golden"] = true
                players[name].inventory[1] = true
                players[name].obj.img = cannon.golden
                decreaseCoin(name, cannon.price.golden)
            end
        end
    end
    if players[name].ui.shopOpened then
        removeShopImg(name)
        addShopImg(name, 775, 50)
        removeShop(name)
        displayShop(name)
    end
end

addShopImg = function(name, x, y)
    players[name].imgs.shopImg = tfm.exec.addImage(players[name].obj.img or cannon.normal, ":0", x, y, name, 0.70, 0.70,
                                     players[name].obj.img and math.rad(90) or 0, 1, 0.5, 0.5)
    ui.addTextArea(textAreaIds.shopArea, "<a href='event:shopEvent'> \n\n </a>", name, x - 10, y - 10, 20, 20, nil,
        0x000001, 0, true)
end

removeShopImg = function(name)
    tfm.exec.removeImage(players[name].imgs.shopImg)
    ui.removeTextArea(textAreaIds.shopArea, name)
end

displayShop = function(name)
    local x1, x2, x3, x4, x5, x6 = 'X', 'X', 'X', 'X', 'X', 'X'
    local c1, c2, c3, c4, c5, c6 = 'FF7D00', 'FF7D00', 'FF7D00', 'FF7D00', 'FF7D00', 'FF7D00'
    local p1, p2, p3, p4, p5, p6 = cannon.price.normal, "[" .. cannon.price.silver .. "]",
        "[" .. cannon.price.orange .. "]", "[" .. cannon.price.bear .. "]", "[" .. cannon.price.hamburger .. "]",
        "[" .. cannon.price.golden .. "]"
    if players[name].obj.img == false then
        players[name].inventory[1] = true
    elseif players[name].obj.img == cannon.silver then
        players[name].inventory[2] = true
    elseif players[name].obj.img == cannon.orange then
        players[name].inventory[3] = true
    elseif players[name].obj.img == cannon.bear then
        players[name].inventory[4] = true
    elseif players[name].obj.img == cannon.hamburger then
        players[name].inventory[5] = true
    elseif players[name].obj.img == cannon.golden then
        players[name].inventory[6] = true
    end

    if players[name].inventory[1] then
        x1 = '&#10003;'
        c1 = '00C4FF'
    end
    if players[name].inventory[2] then
        x2 = '&#10003;'
        c2 = '00C4FF'
    end
    if players[name].inventory[3] then
        x3 = '&#10003;'
        c3 = '00C4FF'
    end
    if players[name].inventory[4] then
        x4 = '&#10003;'
        c4 = '00C4FF'
    end
    if players[name].inventory[5] then
        x5 = '&#10003;'
        c5 = '00C4FF'
    end
    if players[name].inventory[6] then
        x6 = '&#10003;'
        c6 = '00C4FF'
    end
    for i = 1, 6 do
        players[name].inventory[i] = false
    end

    if players[name].bag["silver"] then
        p2 = '<font size="11"><font color="#FFFF00">&#10031;</font></font>'
    end
    if players[name].bag["orange"] then
        p3 = '<font size="11"><font color="#FFFF00">&#10031;</font></font>'
    end
    if players[name].bag["bear"] then
        p4 = '<font size="11"><font color="#FFFF00">&#10031;</font></font>'
    end
    if players[name].bag["hamburger"] then
        p5 = '<font size="11"><font color="#FFFF00">&#10031;</font></font>'
    end
    if players[name].bag["golden"] then
        p6 = '<font size="11"><font color="#FFFF00">&#10031;</font></font>'
    end

    players[name].imgs.shopUiImg = tfm.exec.addImage("17201a440b4.png", ":0", 400, 210, name, 1, 1, 0, 1, 0.5, 0.5)
    players[name].imgs.shopMoneyImg = tfm.exec.addImage("166e9893b89.png", "&0", 175, 100, name, nil, nil, 0, 1, 0.5,
                                          0.5)
    ui.addTextArea(textAreaIds.shopUiArea.money, "<p align='right'><font color='#FFF500'><font size='20'>" ..
        players[name].coin .. "</font></font></p>", name, 165, 85, 100, 30, nil, 0xFFF500, 1, true)

    players[name].inShop[1] = tfm.exec.addImage(cannon.normal, "&0", 300, 140, name, nil, nil, 0, 1, 0.5, 0.5)
    ui.addTextArea(textAreaIds.shopUiArea[1],
        "<p align='center'><a href='event:drag1'>\n\n\n<font size='8'>" .. cannon.price.normal ..
            "</font>\n<font color='#" .. c1 .. "'>" .. x1 .. "</font</p></a>", name, 283, 123, 34, 69, nil, "0x" .. c1,
        1, true)

    players[name].inShop[2] = tfm.exec
                                  .addImage(cannon.silver, "&0", 400, 140, name, nil, nil, math.rad(90), 1, 0.5, 0.5)
    ui.addTextArea(textAreaIds.shopUiArea[2],
        "<p align='center'><a href='event:drag2'>\n\n\n<font size='9'>" .. p2 .. "</font>\n<font color='#" .. c2 .. "'>" ..
            x2 .. "</font></p></a>", name, 383, 123, 34, 69, nil, "0x" .. c2, 1, true)

    players[name].inShop[3] = tfm.exec
                                  .addImage(cannon.orange, "&0", 500, 140, name, nil, nil, math.rad(90), 1, 0.5, 0.5)
    ui.addTextArea(textAreaIds.shopUiArea[3],
        "<p align='center'><a href='event:drag3'>\n\n\n<font size='9'>" .. p3 .. "</font>\n<font color='#" .. c3 .. "'>" ..
            x3 .. "</font></p></a>", name, 483, 123, 34, 69, nil, "0x" .. c3, 1, true)

    players[name].inShop[4] = tfm.exec.addImage(cannon.bear, "&0", 300, 240, name, nil, nil, math.rad(90), 1, 0.5, 0.5)
    ui.addTextArea(textAreaIds.shopUiArea[4],
        "<p align='center'><a href='event:drag4'>\n\n\n<font size='9'>" .. p4 .. "</font>\n<font color='#" .. c4 .. "'>" ..
            x4 .. "</font></p></a>", name, 283, 223, 34, 69, nil, "0x" .. c4, 1, true)

    players[name].inShop[5] = tfm.exec.addImage(cannon.hamburger, "&0", 400, 240, name, nil, nil, math.rad(90), 1, 0.5,
                                  0.5)
    ui.addTextArea(textAreaIds.shopUiArea[5],
        "<p align='center'><a href='event:drag5'>\n\n\n<font size='9'>" .. p5 .. "</font>\n<font color='#" .. c5 .. "'>" ..
            x5 .. "</font></p></a>", name, 383, 223, 34, 69, nil, "0x" .. c5, 1, true)

    players[name].inShop[6] = tfm.exec
                                  .addImage(cannon.golden, "&0", 500, 240, name, nil, nil, math.rad(90), 1, 0.5, 0.5)
    ui.addTextArea(textAreaIds.shopUiArea[6],
        "<p align='center'><a href='event:drag6'>\n\n\n<font size='9'>" .. p6 .. "</font>\n<font color='#" .. c6 .. "'>" ..
            x6 .. "</font></p></a>", name, 483, 223, 34, 69, nil, "0x" .. c6, 1, true)
end

removeShop = function(name)
    tfm.exec.removeImage(players[name].imgs.shopUiImg)
    tfm.exec.removeImage(players[name].imgs.shopMoneyImg)
    for i = 1, 6 do
        tfm.exec.removeImage(players[name].inShop[i])
    end
    ui.removeTextArea(textAreaIds.shopUiArea.money, name)
    for i = 1, 6 do
        ui.removeTextArea(textAreaIds.shopUiArea[i], name)
    end
end

addHelpButton = function(name, x, y)

end

function decreaseCoin(name, decreaseValue)
    players[name].coin = tfm.get.room.playerList[name].score - decreaseValue
    tfm.exec.setPlayerScore(name, players[name].coin, false)
end
